%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%	Package de personnalisation du package UPSTI_Document
% -----------
% Auteur: Emmanuel Bigeard
% email: e.pinault-bigeard@upsti.fr
% -----------
% Version: 0.1 - 2017/11/01
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% UPSTI - http://www.upsti.fr
% CC BY-NC-SA 2.0 FR - http://creativecommons.org/licenses/by-nc-sa/2.0/fr/
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\NeedsTeXFormat{LaTeX2e}[1999/01/01]
\ProvidesPackage{UPSTI_Custom}[2017/11/01]

%==============================================================================%
%	Changelog
%==============================================================================%
% 0.1 - 2017/11/01 - Mise en ligne de la première version


%==============================================================================%
% Personnalisation du modèle
%==============================================================================%
%\usepackage{lmodern}

%--------------------------------------------------------%
% Images
%--------------------------------------------------------%
%\newcommand{\UPSTIcheminImages}{C:/UPSTIlatex/}
\newcommand{\UPSTIcheminImages}{D:/LaTeX/Templates/Richelieu/}
\newcommand{\UPSTIlogoLicence}{\UPSTIcheminImages logoLicence.png}
\newcommand{\UPSTIlogoLycee}{\UPSTIcheminImages logoLycee.png}
\newcommand{\UPSTIlogoAuteur}{\UPSTIcheminImages logoAuteur.png}
\newcommand{\UPSTIlogoAuteurCollegial}{\UPSTIcheminImages logoAuteurCollegial.png}

%--------------------------------------------------------%
% En-têtes et pieds de page
%--------------------------------------------------------%
% En-têtes de pages
\newcommand{\UPSTIenTetePrincipalFiliere}{CPGE TSI}
\newcommand{\UPSTIcoordonneesLycee}{Lycée Richelieu – 64, rue George Sand – 92500 Rueil-Malmaison – Académie de Versailles}

% Pied de page
\newcommand{\UPSTIfooterWebSite}{Emmanuel BIGEARD - \href{http://s2i.bigeard.me}{https://s2i.bigeard.me}}
\newcommand{\UPSTIfooterLycee}{Lycée Richelieu - Rueil-Malmaison}
\newcommand{\UPSTIfooterWebSiteCollegial}{www.lyc-richelieu-rueil.ac-versailles.fr}

%--------------------------------------------------------%
% Meta données du pdf
%--------------------------------------------------------%
\newcommand{\UPSTIauteur}{Emmanuel BIGEARD}
\newcommand{\UPSTImail}{s2i@bigeard.me}

%--------------------------------------------------------%
% Définition des couleurs
%--------------------------------------------------------%
\colorlet{UPSTIcouleurCorrige}{red}
\colorlet{UPSTIcustomColor1}{RoyalBlue}
\colorlet{UPSTIcustomColor2}{red}
\colorlet{UPSTIcustomColor3}{purple}
\colorlet{UPSTIcustomColor4}{ForestGreen}
\colorlet{UPSTIcustomColor5}{Orange}

%--------------------------------------------------------%
% Quelques exemples de personnalisation
%--------------------------------------------------------%
%\renewcommand{\UPSTIversionProf}{\textcolor{red}{~\raisebox{1pt}{$\bigstar$}}} % Signe distinctif pour montrer que c'est une version corrigée (dans l'en-tête)
%\renewcommand*{\UPSTIarrondiBoites}{0} % Arrondi des coins des boîtes
%\renewcommand{\UPSTIintituleKholle}{Khôlle}

%==============================================================================%
% Override: on peut définir ici des changements de variables conditionnels pour le modèle, en fonction de la valeur de \UPSTIvariante
%==============================================================================%
%--------------------------------------------------------%
% Cas général
%--------------------------------------------------------%
\newcommand{\UPSTIeditCustomVars}{

  % Pour overrider certaines macros quelque soit la variante du document
  % \renewcommand*{\nomDeLaCommande} {Valeur}

  % Définition des variantes (si on édite des documents pour différents lycées)
  \ifdef{\UPSTIvariante}{
  \ifcase\UPSTIvariante

    % Variante 0: UPSTI (ne pas modifier cette section)
    \renewcommand{\UPSTIcheminImages}{D:/LaTeX/Templates/UPSTI/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE}
    \renewcommand{\UPSTIcoordonneesLycee}{}
    \renewcommand{\UPSTIfooterWebSite}{www.upsti.fr}
    \renewcommand{\UPSTIfooterLycee}{UPSTI}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{www.upsti.fr}
    \renewcommand{\UPSTIauteur}{UPSTI}
    \renewcommand{\UPSTImail}{contact@upsti.fr}
    \colorlet{UPSTIcustomColor1}{blue}

  \or
    % Variante 1: Lycée n°2 (Chaptal)
    \renewcommand{\UPSTIcheminImages}{D:/LaTeX/Templates/Chaptal/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Chaptal – 45 Boulevard des Batignolles – 75008 Paris}
    \renewcommand{\UPSTIfooterWebSite}{}
    \renewcommand{\UPSTIfooterLycee}{Lycée Chaptal - Paris}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{www.lycee-chaptal-paris.fr}
    \renewcommand{\UPSTIauteur}{Sébastien GERGADIER}
    \renewcommand{\UPSTImail}{prof2sii@gmail.com}
    \colorlet{UPSTIcustomColor2}{ForestGreen}
    \colorlet{UPSTIcustomColor4}{blue}

  \or
    % Variante 2: Lycee n°3 (Jean Zay)
    \renewcommand{\UPSTIcheminImages}{D:/LaTeX/Templates/JeanZay/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE PTSI/PT}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Jean Zay – 21 rue Jean Zay – 63300 Thiers – Académie de Clermont-Ferrand}
    \renewcommand{\UPSTIfooterLycee}{Lycée Jean Zay - Thiers}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{https://cpge-jean-zay.com/}
    \definecolor{UPSTIcustomColor1}{HTML}{61979A}
    % \definecolor{UPSTIcustomColor3}{HTML}{963690}
    \definecolor{UPSTIcustomColor4}{HTML}{359933}
    % \definecolor{UPSTIcustomColor5}{HTML}{FF5600}
    % \colorlet{UPSTIcustomColor4}{RoyalBlue}

  \or
    % Variante 3: Lycee n°4 (Michelet)
    \renewcommand{\UPSTIcheminImages}{D:/LaTeX/Templates/Michelet/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Michelet – 5 Rue Jullien – 92170 Vanves – Académie de Versailles}
    \renewcommand{\UPSTIfooterLycee}{Lycée Michelet - Vanves}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{http://www.michelet-vanves.ac-versailles.fr/}
    \renewcommand{\UPSTIidClasse}{4}  % Forcément PCSI...

  \or
    % Variante 4: Lycee n°5 (Lafayette)
    \renewcommand{\UPSTIcheminImages}{D:/LaTeX/Templates/Lafayette/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{CPGE}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée La Fayette – 21 Bd Robert Schuman – 63000 Clermont-Ferrand – Académie de Clermont-Ferrand}
    \renewcommand{\UPSTIfooterLycee}{Lycée La Fayette - Clermont-Ferrand}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{https://lycee-lafayette-clermont.fr/}
    \colorlet{UPSTIcustomColor1}{ForestGreen}
    \colorlet{UPSTIcustomColor4}{RoyalBlue}

    \or
    % Variante 5: Lycee n°6 (Jean Zay - Ancien)
    \renewcommand{\UPSTIcheminImages}{D:/LaTeX/Templates/JeanZayOld/}
    \renewcommand{\UPSTIenTetePrincipalFiliere}{Licence Pro Robotique}
    \renewcommand{\UPSTIcoordonneesLycee}{Lycée Jean Zay – 21 rue Jean Zay – 63300 Thiers – Académie de Clermont-Ferrand}
    \renewcommand{\UPSTIfooterLycee}{Lycée Jean Zay - Thiers}
    \renewcommand{\UPSTIfooterWebSiteCollegial}{https://www.lyceejeanzay.net/}
    \definecolor{UPSTIcustomColor1}{HTML}{659CA4}
    % \definecolor{UPSTIcustomColor3}{HTML}{963690}
    % \definecolor{UPSTIcustomColor4}{HTML}{359933}
    % \definecolor{UPSTIcustomColor5}{HTML}{FF5600}
    % \colorlet{UPSTIcustomColor4}{RoyalBlue}


    \else
    % Par défaut

  \fi
  }{}
}


%--------------------------------------------------------%
% Dans certains cas, on peut avoir à spécifier des changements de variables ici...
%--------------------------------------------------------%
\newcommand{\UPSTIeditCustomVarsEnd}{
  \ifdef{\UPSTIvariante}{
  \ifcase\UPSTIvariante

    % Variante 0: Lycée Michelet

    \or
      % Variante 1: Seb à Chaptal

    \or
      % Variante 2

    \else
      % Par défaut

  \fi
  }{}

  % Override de variables/commandes
  %\colorlet{UPSTIcustomColor1}{green}  % Exemple: si on veut forcer la CustomColor1 à vert, quelles que soient les modifications de la variable faites précédemment...

  %==============================================================================%
  % Versioning (à utiliser avec le script de compilation)
  % Supprimez ou commenter cette section si vous n'utilisez pas le vbscript de compilation rapide
  %==============================================================================%
  % Packages nécessaires
  \RequirePackage{catchfile}              % |
  \RequirePackage{atveryend}              % | Gestion des fichiers de version et révisions
  \RequirePackage{newfile}                % |

  % On incrémente le compteur dans le fichier révision, pour savoir par curiosité le nombre de compilations totale du fichier
  \newcounter{revisions}
  \IfFileExists{\jobname.revision}{%
    \begingroup
      \CatchFileEdef\tmp{\jobname.revision}{\endlinechar=-1\relax}%
      \setcounter{revisions}{\tmp}%
    \endgroup
  }{}
  \stepcounter{revisions}

  % On créée un fichier de version en fonction de la variable \UPSTInumeroVersion
  \ifdef{\UPSTInumeroVersion}{
  \AtVeryEndDocument{%
    \newoutputstream{revision}%
    \openoutputfile{\jobname.revision}{revision}%
    \addtostream{revision}{\number\value{revisions}}%
    \closeoutputstream{revision}%
    \newoutputstream{version}%
    \openoutputfile{\jobname.version}{version}%
    \addtostream{version}{\UPSTInumeroVersion}%
    \closeoutputstream{version}%
  }
  }{}
}
\endinput
